## 1. Administrar VM ARC

```kusto
// Alerta si una extensión de Arc falla
Heartbeat
| where ResourceType == "microsoft.hybridcompute/machines"
| join kind=inner (
    ConfigurationChange
    | where ChangeCategory == "Extensions"
    | where ChangedProperties contains "Failed"
) on ResourceId
```

## 2. Administrar SQL

```kusto
// Alertas sobre Defender for Cloud para SQL Arc
SecurityAlert
| where ResourceId contains "microsoft.azurearcdata/sqlserverinstances"
| where TimeGenerated > ago(1h)

```

## 3. Administrar Kubernetes

```kusto
// Alerta si un clúster Arc pierde conectividad (no envía heartbeat)
Heartbeat
| where ResourceType == "microsoft.kubernetes/connectedclusters"
| summarize LastSeen = max(TimeGenerated) by Resource
| where LastSeen < ago(30m)
```